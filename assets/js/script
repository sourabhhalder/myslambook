// This alert will prove the file is finally connected!
alert("Connection Successful: JavaScript is now running!");

document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('slambookForm');

    form.addEventListener('submit', function(e) {
        // This stops the URL from getting long and the page from refreshing
        e.preventDefault(); 
        
        console.log("Sending data to Node.js...");

        const formData = new FormData(this);
        const data = Object.fromEntries(formData);

        fetch('http://localhost:3000/save-entry', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        })
        .then(response => {
            if (response.ok) {
                showPopup(); // Your confetti function
            } else {
                alert("Server error. Is the Excel file open? Please close it!");
            }
        })
        .catch(err => {
            alert("Node.js Server is not responding! Make sure the terminal window is open.");
        });
    });
});